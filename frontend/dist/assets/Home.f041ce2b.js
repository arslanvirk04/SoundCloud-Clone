import{b as f,u as k,r,t as A,s as x,j as o,c as s,N as $,B as q,C as Q,D as W,E as X,G as Z,H as ee,I as se,v as te,J as ae,K as M,M as oe,h as re}from"./index.ed1e7a57.js";import{C as S}from"./index.fd20f91f.js";import{M as le}from"./react-responsive-modal.esm.09526b33.js";/* empty css               */import{I as ne,_ as m}from"./index.793864eb.js";import{T as ie}from"./Title.2c53770e.js";import"./index.aeda6e92.js";function de({item:t}){const{current:c,playing:g,controls:n}=f(e=>e.player),a=k(),[h,i]=r.exports.useState(!1),[d,u]=r.exports.useState(!1),[w,C]=r.exports.useState(""),[P,N]=r.exports.useState(""),[I,F]=r.exports.useState(!1),E=f(e=>e.playlists?.playlists),{session:D}=f(e=>e),p=D?.user?.id,L=Array.isArray(E)?E?.filter(e=>e?.userId===p):[],v=f(e=>e.likedSongs?.likedSongs||[]),[ue,T]=r.exports.useState(null),[H,b]=r.exports.useState(v.some(e=>e?.Song?.id===t?.id));r.exports.useEffect(()=>{b(v.some(e=>e?.songId===t?.id&&e.userId===p))},[v,t?.id]),r.exports.useEffect(()=>()=>{a(A(null)),a(x(!1))},[]);const z=()=>{switch(t?.type){case"artist":return"rounded-full";case"podcast":return"rounded-xl";default:return"rounded"}},B=async()=>{try{const e=t?.id;await a(ee({userId:p,songId:e}))&&(b(!0),m.success("Song has been added to Liked!",{duration:1e3,position:"top-right"}))}catch(e){console.error("Failed to update liked status:",e),m.error("Failed to update liked status. Please try again.",{duration:2e3,position:"top-right"})}},O=async()=>{try{await a(se(t?.id))&&(b(!1),m.success("Song has been removed from Liked!",{duration:1e3,position:"top-right"}))}catch(e){console.error("Failed to update liked status:",e),m.error("Failed to update liked status. Please try again.",{duration:2e3,position:"top-right"})}},_=async()=>{if(c&&c.id===t?.id)g?(n?.pause&&n.pause(),a(x(!1))):(n?.play&&n.play(),a(x(!0)));else{const e=await U(t?.id);a(A(e||t)),a(x(!0))}},U=async e=>{if(!!e)try{const l=await a(te(e));return T(l?.currentSong),l?.currentSong}catch(l){console.error("Error fetching genres:",l)}},G=()=>{F(!I)},J=e=>{switch(e){case"add-to-playlist":u(!0);break}F(!1)},K=async()=>{try{if(!w){N("Please enter a playlist name.");return}const e=t?.id,y=await a(ae({userId:p,name:w,songId:e})),j={userId:p,playlistId:y.id,songId:e},ge=await a(M(j));y&&(m.success("Playlist has been created!",{duration:3e3,position:"top-right"}),C(""),u(!1),N(""))}catch(e){console.error("Failed to add song to playlist:",e),N("Failed to add song to playlist. Please try again.")}},R=async e=>{try{const l=t?.id;await a(M({userId:p,playlistId:e,songId:l}))&&(m.success("Song has been added!",{duration:1e3,position:"top-right"}),u(!1))}catch(l){console.error("Failed to add song to playlist:",l)}},V=()=>{i(!0)},Y=()=>{i(!1)};return o("div",{children:[o("div",{className:"bg-gray-900 rounded-lg overflow-auto shadow-md transition duration-300 ease-in-out transform hover:-translate-y-1 hover:shadow-lg",children:[s("div",{className:"relative",onMouseEnter:()=>V(),onMouseLeave:()=>Y(),children:o($,{to:"/dashboard",children:[s("img",{src:t?.imgUrl,alt:t?.title,className:`w-full h-48 object-cover ${z()}`}),h&&t?.hasFile==="1"&&s("div",{className:"absolute inset-0 flex items-center justify-center",children:s("div",{className:"bg-green-600 rounded-full p-2",onClick:_,children:c?.id===t?.id&&g?s(q,{className:"text-white text-sm"}):s(Q,{className:"text-white text-sm"})})})]})}),s("div",{className:"p-4",children:o("div",{className:"flex flex-col",children:[o("div",{className:"flex items-center gap-4 justify-between",children:[s("p",{className:"text-gray-400",children:t?.artist}),o("div",{className:"relative",children:[s(W,{className:"text-gray-400",onClick:G}),I&&s("div",{className:"absolute right-0 mt-1  sm:w-30 md:w-36 lg:w-38  bg-gray-400 rounded-lg shadow-lg z-10",children:s("div",{className:"px-4 py-2 hover:bg-gray-700 cursor-pointer",onClick:()=>J("add-to-playlist"),children:"Add to Playlist"})})]})]}),o("div",{className:"flex items-center gap-4 justify-between",children:[s("div",{className:"truncate-text overflow-hidden overflow-ellipsis whitespace-nowrap max-w-xs",children:t?.title}),H?s(X,{color:"red",size:18,onClick:O}):s(Z,{color:"white",size:18,onClick:B})]})]})}),s(le,{open:d,onClose:()=>u(!1),center:!0,classNames:{modal:"custom-modal",closeButton:"custom-closeButton"},children:o("div",{className:"bg-gray-900 p-8 rounded-lg w-96",children:[s("h3",{className:"text-lg font-semibold text-white mb-4",children:"Add to Playlist"}),s("h2",{className:"text-white font-semibold",children:"Existing Playlists"}),s("div",{className:"flex flex-col gap-4",children:L.length>0?L.map(e=>o("div",{className:"bg-gray-800 flex items-center justify-between rounded-lg p-4 shadow-md transition duration-300 ease-in-out transform hover:-translate-y-1 hover:shadow-lg",children:[s("h3",{className:"text-white font-semibold overflow-hidden overflow-ellipsis whitespace-nowrap",children:e?.name}),s("button",{className:"bg-green-500 text-white px-4 py-1 rounded-lg",onClick:()=>R(e?.id),children:"Add"})]},e?.id)):s("p",{className:"text-white",children:"No playlist found!"})}),o("div",{className:"mt-4",children:[s("h2",{className:"text-white font-semibold",children:"Create New Playlist"}),o("div",{className:"flex items-center",children:[s("input",{type:"text",placeholder:"Playlist Name",value:w,onChange:e=>C(e.target.value),className:"border border-gray-700 px-3 py-1 rounded-lg w-full mt-2 focus:outline-none focus:border-blue-500"}),s("button",{onClick:K,className:"bg-green-500 text-white px-4 py-1 ml-2 rounded-lg",children:"Create"})]}),P&&s("p",{className:"text-red-500 mt-2",children:P})]}),s("button",{onClick:()=>u(!1),className:"bg-red-500 text-white px-4 py-1 rounded-lg mt-4",children:"Close"})]})})]}),s(ne,{})]})}function ce({title:t,more:c=!1,items:g}){const n=k(),{session:a}=f(i=>i),h=a?.user?.id;return r.exports.useEffect(()=>{h&&n(oe())},[n,h]),o("section",{className:"",children:[s(ie,{title:t,more:c}),s("div",{className:"grid text-white grid-cols-1 xs:grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 pb-16",children:g?.map(i=>s(de,{item:i},i?.id))})]})}function Ne(){const t=k(),[c,g]=r.exports.useState([]),[n,a]=r.exports.useState(!1),h=f(d=>d.songs?.trendingSongs?.trendSongs);r.exports.useEffect(()=>{i()},[]);const i=async()=>{try{a(!0);const d=await t(re());g(d?.trendSongs?.slice(0,15)),a(!1)}catch(d){console.error("Error fetching genres:",d),a(!1)}};return n?s(S,{children:s("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6 p-6",children:Array(15).fill().map((d,u)=>o("div",{className:"bg-gray-900 rounded-lg overflow-hidden shadow-md animate-pulse",children:[s("div",{className:"w-full h-48 bg-gray-700"}),o("div",{className:"p-4",children:[s("div",{className:"h-4 bg-gray-700 mb-2"}),s("div",{className:"h-4 bg-gray-700 w-3/4"})]})]},u))})}):h?.length===0?s(S,{children:s("div",{className:"flex items-center justify-center h-full py-80 text-white",children:o("div",{className:"text-center",children:[s("h2",{className:"text-3xl font-bold text-white-900 mb-4",children:"No Songs Found"}),s("p",{className:"text-lg text-white-700",children:"You haven't added any songs yet."})]})})}):o(S,{children:[s(ce,{title:"All Songs",more:"/blabla",items:c})," "]})}export{Ne as default};
