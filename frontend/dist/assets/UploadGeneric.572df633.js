import{r as l,c as e,R as de,u as _,a as ue,b as J,S as me,T as he,v as ge,j as o,F as Z,U as be,h as pe}from"./index.ed1e7a57.js";import{I as fe,n as N}from"./index.793864eb.js";import{M as xe}from"./react-responsive-modal.esm.09526b33.js";/* empty css               */import{C as we}from"./index.fd20f91f.js";import{R as ve}from"./react-table.a34033a9.js";import"./index.aeda6e92.js";function ye(d,u){return e("svg",{...Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:u},d),children:e("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z",clipRule:"evenodd"})})}const ke=l.exports.forwardRef(ye),Ne=ke,V="/assets/album2.863430f3.jpeg",W="/assets/album3.60bccffe.jpeg";function Se({editSongId:d}){const[u,p]=l.exports.useState(""),[f,x]=l.exports.useState(""),[w,m]=l.exports.useState(""),[b,S]=l.exports.useState([]),[n,C]=l.exports.useState({}),[F,v]=l.exports.useState([]),[s,h]=l.exports.useState(""),[y,I]=l.exports.useState(""),[P,$]=l.exports.useState(""),[G,H]=l.exports.useState(""),[L,M]=l.exports.useState(null),[O,A]=l.exports.useState(null),[X,U]=l.exports.useState(null),[q,K]=l.exports.useState(!1),[Q,T]=de.useState(!1),[ee,te]=l.exports.useState(""),[j,le]=l.exports.useState(""),[a,E]=l.exports.useState(!1),[se,R]=l.exports.useState(!1),k=_(),z=ue(),D=J(t=>t.session.user);l.exports.useEffect(()=>{D&&oe()},[D]),l.exports.useEffect(()=>{const t=F.filter(r=>r.type==="artist");S(t)},[F]),l.exports.useEffect(()=>{if(q){const t=setTimeout(()=>{z.push("/dashboard")},2e3);return()=>clearTimeout(t)}},[q,z]);const oe=async()=>{try{const t=await k(me()),r=await k(he());v(r),le(t)}catch(t){console.error("Error fetching genres:",t)}},re=async t=>{if(t.preventDefault(),!L&&!y){N.error("Please upload an audio file or provide a YouTube youtubeLink.");return}if(!O){N.error("Please select an album cover image.");return}E(!0);const r={title:u,artist:w,genre:f,albumName:s,youtubeLink:y,facebookLink:P,tiktokLink:G,audioFile:L?L.audioFile:null,imgUrl:O,userId:D.id};try{await k(be(r)),N.success("Song has been uploaded!",{duration:3e3,position:"top-right"}),K(!0),E(!1)}catch{E(!1),N.error("Error uploading song. Please try again later.")}};l.exports.useEffect(()=>{d&&ae(d)},[d]);const ae=async t=>{R(!0);try{const r=await k(ge(t));C(r?.currentSong),R(!1)}catch(r){R(!1),console.error("Error fetching song data:",r)}};l.exports.useEffect(()=>{n&&(p(n.title||""),x(n.genre||""),m(n.artist||""),h(n.album||""),I(n.youtubeLink||""),$(n.facebookLink||""),H(n.tiktokLink||""),M(n.audioFile||null),A(n.imgUrl||null),U(n.imgUrl||null))},[n]);const ne=t=>{const r=t.target.files[0],{name:i}=t.target,c=new FileReader;c.readAsDataURL(r),c.onload=()=>{M(g=>({...g,[i]:c.result})),te(r.name)},c.onerror=g=>{console.error("Error converting file to base64:",g)}},ie=t=>{const r=t.target.files[0],i=new FileReader;i.readAsDataURL(r),i.onload=()=>{const c=i.result;A(c),U(c)},i.onerror=c=>{console.error("Error converting file to base64:",c)}},ce=()=>{T(!0)},B=()=>{T(!1)},Y=t=>{const r=new Image;r.src=t,r.onload=()=>{const i=document.createElement("canvas");i.width=r.width,i.height=r.height,i.getContext("2d").drawImage(r,0,0);const g=i.toDataURL("image/jpeg");A(g),U(g),T(!1)}};return o(we,{children:[o("div",{className:"w-full",children:[e("h1",{className:"text-4xl font-bold text-center text-white mb-2",children:"Upload song"}),e("p",{className:"text-xl text-center text-white mb-2",children:"Add music of your own choice"}),se?e("div",{className:"flex justify-center items-center",children:e(Z,{className:"animate-spin text-white h-10 w-10 mt-12"})}):o("form",{onSubmit:re,className:"grid grid-cols-2 gap-6 p-1",children:[o("div",{className:"w-full",children:[e("label",{htmlFor:"title",className:"block font-medium text-white mt-2",children:"Title"}),e("input",{type:"text",name:"title",id:"title",style:{height:"30px"},value:u,disabled:a,onChange:t=>p(t.target.value),className:`mt-0.5 block w-full rounded-md bg-gray-700 text-white border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2.5 ${a?"cursor-not-allowed opacity-50 ":""}`,required:!0})]}),o("div",{className:"w-full",children:[e("label",{htmlFor:"artist",className:"block font-medium text-white mt-2",children:"Artist"}),o("select",{name:"artist",id:"artist",value:w,disabled:a,onChange:t=>m(t.target.value),className:`h-1/2 mt-0.5 block w-full rounded-md bg-gray-700 text-white border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2.5 ${a?"cursor-not-allowed":""}`,required:!0,children:[e("option",{value:"",disabled:!0,hidden:!0,children:"Select Artist"}),b&&b?.length>0?b?.map(t=>e("option",{value:t?.username,children:t?.username},t?.id)):e("option",{disabled:!0,children:"No artists available"})]})]}),o("div",{className:"w-full",children:[e("label",{htmlFor:"genre",className:"block font-medium text-white mt-2",children:"Genre"}),o("select",{name:"genre",id:"genre",value:f,disabled:a,onChange:t=>x(t.target.value),className:`h-1/2 mt-0.5 block w-full rounded-md bg-gray-700 text-white border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2.5 ${a?"cursor-not-allowed":""}`,required:!0,children:[e("option",{value:"",disabled:!0,hidden:!0,children:"Select genre"}),j&&j?.length>0?j?.map(t=>e("option",{value:t.genre,children:t.genre},t.id)):e("option",{disabled:!0,children:"No genres available"})]})]}),o("div",{className:"w-full",children:[e("label",{htmlFor:"albumName",className:"block font-medium text-white mt-2",children:"Album Name"}),e("input",{type:"text",name:"albumName",id:"albumName",style:{height:"30px"},value:s,disabled:a,onChange:t=>h(t.target.value),className:`mt-0.5 block w-full rounded-md bg-gray-700 text-white border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2.5 ${a?"cursor-not-allowed opacity-50":""}`,required:!0})]}),o("div",{className:"w-full",children:[e("label",{htmlFor:"youtubeLink",className:"block font-medium text-white mt-2",children:"Youtube Link"}),e("input",{type:"text",name:"youtubeLink",id:"youtubeLink",style:{height:"30px"},value:y,disabled:a,onChange:t=>I(t.target.value),className:`mt-0.5 block w-full rounded-md bg-gray-700 text-white border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2.5 ${a?"cursor-not-allowed opacity-50":""}`})]}),o("div",{className:"w-full",children:[e("label",{htmlFor:"facebookLink",className:"block font-medium text-white mt-2",children:"Facebook Link"}),e("input",{type:"text",name:"facebookLink",id:"facebookLink",style:{height:"30px"},value:P,disabled:a,onChange:t=>$(t.target.value),className:`mt-0.5 block w-full rounded-md bg-gray-700 text-white border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2.5 ${a?"cursor-not-allowed opacity-50":""}`})]}),o("div",{className:"w-full",children:[e("label",{htmlFor:"tiktokLink",className:"block font-medium text-white mt-2",children:"Tiktok Link"}),e("input",{type:"text",name:"tiktokLink",id:"tiktokLink",style:{height:"30px"},value:G,disabled:a,onChange:t=>H(t.target.value),className:`mt-0.5 block w-full rounded-md bg-gray-700 text-white border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2.5 ${a?"cursor-not-allowed opacity-50":""}`})]}),e("div",{className:"w-full"}),o("div",{className:"w-full",children:[e("label",{htmlFor:"imgUrl",className:"block font-medium text-white mt-2",children:"Album Cover Image"}),o("div",{className:"flex items-center w-full mt-2",children:[o("label",{htmlFor:"imgUrlInput",className:`flex flex-col items-center justify-center w-2/5 h-36 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-700 text-white ${a?"cursor-not-allowed":""}`,children:[e(Ne,{className:"w-12 h-12 mb-3"}),e("span",{className:"font-semibold",children:"Upload Album Cover"}),e("input",{type:"file",name:"imgUrl",id:"imgUrlInput",style:{height:"30px"},onChange:ie,accept:"image/*",className:"hidden",disabled:a}),e("button",{type:"button",className:"mt-4 text-gray-500 text-sm",onClick:ce,disabled:a,children:"Choose default image"})]}),X&&e("img",{src:X,alt:"Album Cover Preview",className:"w-32 h-32 rounded-lg border border-gray-500 ml-4"})]})]}),o("div",{className:"w-full",children:[e("label",{htmlFor:"audioFile",className:"block font-medium text-white mt-2",children:"Audio File"}),o("div",{className:"flex items-center justify-center w-full mt-2",children:[o("label",{htmlFor:"audioFileInput",className:"flex items-center justify-center w-full h-36 bg-gray-700 rounded-lg cursor-pointer",children:[e("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.5 14h-.75l-1.75-1.75c-.28-.28-.75-.28-1.06 0l-2.5 2.5c-.28.28-.28.75 0 1.06l2.5 2.5c.28.28.75.28 1.06 0l1.75-1.75 1.75 1.75c.5.5.5 1.25 0 1.75l-2.25 2.25c-.28.28-.75.28-1.06 0l-2.5-2.5c-.28-.28-.28-.75 0-1.06l2.5-2.5c.28-.28.28-.75 0-1.06l-2.5-2.5c-.5-.5-.28-1.25 0-1.75l2.25-2.25c.28-.28.28-.75 0-1.06l-2.5-2.5c-.28-.28-.75-.28-1.06 0l-2.25 2.25c-.28.28-.75.28-1.06 0l1.75 1.75c.28.28.28.75 0 1.06l-2.5 2.5c-.28.28-.75.28-1.06 0l-2.25 2.25c-.28-.28-.28-.75 0-1.06l2.5-2.5c-.28-.8.75 0 1.06l-2.5 2.5c-.28.28-.75.28-1.06 0l-2.25 2.25c-.28.28-.75.28-1.06 0l1.75 1.75c.28.28.28.75 0 1.06l-2.5 2.5c-.5.5.28.75 0 1.75l2.25 2.25c.28.28.28.75 0 1.06l-2.5 2.5c-.28.28-.75.28-1.06 0l-2.25 2.25c-.28-.28-.28-.75 0-1.06l2.5-2.5c-.28-.28-.75-.28-1.06 0l-1.75 1.75c-.28.28-.75.28-1.06 0l1.75 1.75c.28.28.28.75 0 1.06l-2.5 2.5c-.28.28-.75.28-1.06 0l-2.25-2.25c-.28-.28-.28-.75 0-1.06l2.5-2.5c-.28-.28-.75-.28-1.06 0l.17-.23-.17-.23v-8h16v12Zm0-18.5lX12.7 12.7l-12.7 12.7-X22.33 22.33-X22.33-22.33-.33v15.02l-X3 3X12.7.94lX4.28-4.28V25l-6.94-6.92Zg5.22-.59L15 17.66 3.44 7.57L2 9 v15l4.99 6.38h13.15l3.73-3.77Z "})}),e("p",{className:"ml-4 font-semibold text-white text-lg",children:ee||"Upload Audio"})]}),e("input",{type:"file",name:"audioFile",id:"audioFileInput",style:{height:"1px"},onChange:ne,accept:".mp3",className:"hidden"})]})]}),e("div",{className:"col-span-2 flex justify-end items-end pb-24",children:a?o("div",{className:"flex items-center justify-end",children:[e(Z,{className:"animate-spin text-white h-6 w-6"}),e("span",{className:"ml-2 text-white",children:"Uploading..."})]}):e("button",{type:"submit",className:"text-white py-1 px-3 border border-transparent rounded-md shadow-sm font-medium bg-green-500 hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",disabled:a,children:"Submit"})})]}),e(fe,{})]}),e(xe,{open:Q,onClose:B,classNames:{modal:"absolute right-0 top-0 w-1/3  border-l border-gray-300",overlay:"bg-black bg-opacity-50"},children:o("div",{className:"p-4 text-center bg-gray-800 text-white shadow-md rounded-lg",children:[e("h2",{className:"text-2xl font-bold mb-4",children:"Default Cover Images"}),o("div",{className:"grid grid-cols-3 gap-4",children:[e("img",{src:V,alt:"Default Cover 1",className:"w-32 h-32 rounded-lg object-cover cursor-pointer",onClick:()=>Y(V)}),e("img",{src:W,alt:"Default Cover 2",className:"w-32 h-32 rounded-lg object-cover cursor-pointer",onClick:()=>Y(W)})]}),e("button",{type:"button",className:"mt-4 text-blue-500",onClick:B,children:"Close"})]})})]})}function Ee(){const[d,u]=l.exports.useState(0),[p,f]=l.exports.useState([]),[x,w]=l.exports.useState(null),m=J(s=>s.session.user),b=_();l.exports.useEffect(()=>{m&&S()},[m]);const S=async()=>{try{const s=await b(pe());f(s.trendSongs)}catch(s){console.error("Error fetching user songs:",s)}},n=p.filter(s=>s.artist===m.username),C=s=>{w(s),u(0)},v=[{id:0,label:"Upload Songs",content:e("div",{children:e(Se,{editSongId:x})})},{id:1,label:"Songs",content:e("div",{children:e("div",{className:"w-full",children:e(ve,{data:n,columns:[{Header:"Title",accessor:"title",style:{color:"white"}},{Header:"Artist",accessor:"artist",style:{color:"white"}},{Header:"Genre",accessor:"genre",style:{color:"white"}},{Header:"Actions",Cell:({row:s})=>e("button",{className:"text-white py-1 px-5 border border-transparent rounded-lg shadow-md font-medium text-lg bg-green-500 hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",onClick:()=>C(s._original.id),children:"Edit"}),style:{color:"white"}}],defaultPageSize:10,showPageSizeOptions:!0,minRows:0,getTheadThProps:()=>({style:{backgroundColor:"#333",color:"white",padding:"10px",textAlign:"left"}}),getTheadTrProps:()=>({style:{backgroundColor:"rgba(255, 255, 255, 0.1)"}}),getTrProps:(s,h,y)=>({style:{backgroundColor:h&&h.row&&h.row.index%2===0?"rgba(255, 255, 255, 0.1)":"rgba(255, 255, 255, 0.05)",color:"white",padding:"10px"}}),NoDataComponent:()=>e("div",{className:"text-white",style:{textAlign:"center",padding:"20px"},children:"No songs found"})})})})}];return o("div",{children:[e("div",{className:"flex gap-20 border-gray-200",children:v.map(s=>e("button",{className:`px-4 py-2  font-medium ${d===s.id?"border-b-2 border-green-500 text-white":"text-gray-400"}`,onClick:()=>u(s.id),children:s.label},s.id))}),e("div",{className:"p-4 mb-12",children:v.find(s=>s.id===d)?.content})]})}export{Ee as default};
